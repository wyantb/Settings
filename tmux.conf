
# yes, 256 colors please
set -g default-terminal "screen-256color"

# set window and pane index to 1 (0 by default)
set-option -g base-index 1
setw -g pane-base-index 1

# use vim keys
setw -g mode-keys vi

# reload ~/.tmux.conf using PREFIX r
#  From: https://github.com/zanshin/dotfiles/blob/master/tmux/tmux.conf
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Smart pane switching with awareness of vim splits
bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$' && tmux send-keys C-h) || tmux select-pane -L"
bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$' && tmux send-keys C-j) || tmux select-pane -D"
bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$' && tmux send-keys C-k) || tmux select-pane -U"
bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$' && tmux send-keys C-l) || tmux select-pane -R"
bind -n C-\ run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$' && tmux send-keys 'C-\\') || tmux select-pane -l"

# Go to last active window
bind-key C-a last-window

# Pass ctrl-left, etc, through to app/terminal
set-window-option -g xterm-keys on

# Size window size to best available per each window, not per session
setw -g aggressive-resize on

# Add a key for killing current session (as opposed to d which just detaches)
# ...but prompt first.  I'm not ashamed to admit I've killed a few sessions I didn't intend to
bind-key k confirm-before -p "kill-session #S? (y/n)" kill-session

# Ugly but more functional I think - highlight active window in statusbar
set-window-option -g window-status-current-bg white

# Lots of history, please
set-option -g history-limit 20000

# With caps lock as Ctrl, and this, much nicer than the defaults
set -g prefix C-a

# Let [esc] take effect earlier
set -s escape-time 1

# Easier bindings to remember for splitting tmux
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Bump the default repeat time just a little, mostly for c-j c-k
repeat-time 750

# Repeatable keys for moving through windows in current session
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+
# or between clients
bind -r C-j switch-client -p
bind -r C-k switch-client -n

# Repeatable keys for pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Pipe output into log
bind P pipe-pane -o "cat >>~/#W.log" \; display "Toggled logging to ~/#W.log"
